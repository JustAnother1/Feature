<?xml version="1.0" encoding="utf-8" ?>
<algorithm name="pwm_task" api="run">
    <configurationAttribute name="frequency_Hz"/>
    <configurationAttribute name="dutyCycle_percent"/>
    <required>
        <parameter ref="dutyCycle_percent" />
        <parameter ref="frequency_Hz" />
        <childElement type="binaryOut"/>
    </required>
    <c_code>
        <required>
            <libraryAlgorithm type="delay"/>
        </required>
        <additional>
            <include>util/delay.h</include>
        </additional>
        <function  name="initialize">
            <![CDATA[$$$binaryOut:initialize()$$$]]>
        </function>
        <function name="execute">
            <![CDATA[
    $$$binaryOut:setValue(true)$$$
    $$$delay:delay_ms(10 / frequency_Hz * dutyCycle_percent)$$$ // Delay
    $$$binaryOut:setValue(false)$$$
    $$$delay:delay_ms(10 / frequency_Hz * (100 - dutyCycle_percent))$$$ // Delay]]>
        </function>
    </c_code>
</algorithm>
